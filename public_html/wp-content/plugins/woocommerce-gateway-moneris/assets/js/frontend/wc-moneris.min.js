function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}function _callSuper(e,t,r){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,r||[],_getPrototypeOf(e).constructor):t.apply(e,r))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}jQuery(function(n){window.WC_Moneris_Payment_Form_Handler=(()=>{function o(e){_classCallCheck(this,o),(t=_callSuper(this,o,[e])).ticketNumber=t.hasTicketNumber()?t.getTicketField().val():"",t.environment=e.environment,t.isCheckoutLoggingEnabled=e.isCheckoutLoggingEnabled,t.isPayPageEnabled=e.isPayPageEnabled,t.clearErrors=n("form.checkout").length;var t,r=t;return n("#wc-moneris-csc_field").hide(),t.formInitialized||n("form.checkout").length||(r.ticketNumber?r.initForm():t.showErrorMessage("-pay-page"),t.placeOrderButtonHandling(),t.handleCSCForSavedCards()),n(document).on("updated_checkout",function(){r.initializingForm=!1,r.ticketNumber=t.hasTicketNumber()?t.getTicketField().val():"",t.placeOrderButtonHandling(),t.handleCSCForSavedCards(),r.ticketNumber?r.initForm():t.showErrorMessage(),t.isCheckoutLoggingEnabled&&t.woocommerceError&&n(".woocommerce-NoticeGroup").prepend(t.woocommerceError)}),n("form.checkout").length&&n(document).on("change","#customer_details input, #customer_details select, #terms",function(){"wc-moneris-ticket"===n(this).attr("name")||"createaccount"===n(this).attr("name")||r.isPayPageEnabled||n(document.body).trigger("update_checkout")}),n(document).on("checkout_error",function(){t.isCheckoutLoggingEnabled&&(t.woocommerceError=0<n(".woocommerce-error").length?n(".woocommerce-error")[0].outerHTML:""),n("body").trigger("update_checkout")}),window.recaptchaSuccessCallback=function(){grecaptcha.getResponse()&&(t.unblockMonerisForm(),window.recaptchaInterval=setInterval(function(){n("#wc-moneris-credit-card-checkout-form .blockUI.blockOverlay").length?clearInterval(window.recaptchaInterval):r.greCaptchaHandling()},1e3))},t}return _inherits(o,SV_WC_Payment_Form_Handler_v5_15_12),_createClass(o,[{key:"hasTicketNumber",value:function(){return this.getTicketField().val()&&0<this.getTicketField().val().length}},{key:"handleCSCForSavedCards",value:function(){this.toggleCSCField(),n("input.js-wc-moneris-payment-token").change(this.toggleCSCField)}},{key:"toggleCSCField",value:function(){var e=n("input.js-wc-moneris-payment-token:checked").val(),t=n("div.js-wc-moneris-new-payment-method-form"),r=n("#wc-moneris-csc_field");r.length&&(e?(t.slideUp(200),r.removeClass("form-row-last").slideDown(200)):(t.slideDown(200),r.slideUp(200)))}},{key:"getTicketField",value:function(){return n("#wc-"+this.id_dasherized+"-ticket")}},{key:"showErrorMessage",value:function(){n("#wc-"+this.id_dasherized+"-error-message"+(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"")).show()}},{key:"validate_card_data",value:function(){var e,t;return!(n("form.checkout").is(".processing")||n("input.js-wc-moneris-payment-token:checked").val()&&(e=[],void 0!==(t=n(".payment_method_moneris").find("#wc-moneris-csc").val())&&(t?(/\D/.test(t)&&e.push(sv_wc_payment_gateway_payment_form_params.cvv_digits_invalid),(t.length<3||4<t.length)&&e.push(sv_wc_payment_gateway_payment_form_params.cvv_length_invalid)):e.push(sv_wc_payment_gateway_payment_form_params.cvv_missing)),0<e.length)&&(this.render_errors(e),1))}},{key:"do_inline_credit_card_validation",value:function(){}},{key:"handleError",value:function(e){this.debugLog("error occurred")}},{key:"initForm",value:function(){var t=this;this.initializingForm||(this.initializingForm=!0,this.monerisForm=new monerisCheckout,this.monerisForm.setCheckoutDiv("wc-"+this.id_dasherized+"-credit-card-checkout-form"),this.monerisForm.setMode(this.environment),this.togglePlaceOrderButton(),n("#wc-moneris-container").hide(),this.monerisForm.startCheckout(this.ticketNumber),this.monerisForm.setCallback("page_loaded",function(e){t.initializingForm=!1,t.formInitialized=!0,n("#wc-moneris-container").show(),t.handlePaymentFormReady(e),t.termsCheckboxHandling(),t.clearErrors=!0}),this.monerisForm.setCallback("error_event",function(e){t.handleError(e)}),this.monerisForm.setCallback("payment_complete",function(e){t.clearErrors=!1;e=JSON.parse(e);"001"===e.response_code&&(t.getTicketField().val(e.ticket),t.form.submit())}))}},{key:"handlePaymentFormReady",value:function(e){e.type&&"ready"===e.type?this.debugLog("Payment form ready"):this.debugLog(e),this.form.unblock()}},{key:"termsCheckboxHandling",value:function(){var e,t=this;this.greCaptchaHandling(),n("body.woocommerce-order-pay").length&&n("#terms").length&&(e="Please read and accept the terms and conditions below to proceed with your order.",n("#terms:checked").val()||this.blockMonerisForm(e),n(document).on("change","#terms",function(){"on"===n("#terms:checked").val()?t.unblockMonerisForm():t.blockMonerisForm(e)}))}},{key:"greCaptchaHandling",value:function(){if((n("#g-recaptcha-checkout-i13").length||n("#g-recaptcha-payment-method").length)&&n("#wc-moneris-credit-card-checkout-form-Frame").length){var t="Please verify captcha below to proceed with your order.";try{grecaptcha&&!grecaptcha.getResponse()&&this.blockMonerisForm(t)}catch(e){this.blockMonerisForm(t)}}}},{key:"blockMonerisForm",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";n("#wc-moneris-credit-card-checkout-form").block({css:{width:"80%"},message:e})}},{key:"unblockMonerisForm",value:function(){n("#wc-moneris-credit-card-checkout-form").unblock(),this.termsCheckboxHandling()}},{key:"debugLog",value:function(e){this.isLoggingEnabled&&console.log(e)}},{key:"userHasSavedPaymentMethods",value:function(){return 0<n('[name="wc-moneris-payment-token"]').length}},{key:"placeOrderButtonHandling",value:function(){var e=this;n('[name="wc-moneris-payment-token"]').on("change",function(){""===n('[name="wc-moneris-payment-token"]:checked').val()&&e.hasTicketNumber()?(e.clearErrors&&n(".woocommerce-error").remove(),n("#place_order").attr("disabled",!0),n("#wc-moneris-tokenize-payment-method").parent().show()):(n("#place_order").attr("disabled",!1),n("#wc-moneris-tokenize-payment-method").parent().hide()),e.termsCheckboxHandling()}).change(),n('input[name^="payment_method"]').on("change",function(){e.togglePlaceOrderButton()})}},{key:"togglePlaceOrderButton",value:function(){"moneris"===n("input[name=payment_method]:checked").val()?this.userHasSavedPaymentMethods()?n('[name="wc-moneris-payment-token"]').change():this.hasTicketNumber()?(this.clearErrors&&n(".woocommerce-error").remove(),n("#place_order").attr("disabled",!0),n("#wc-moneris-tokenize-payment-method").parent().show()):(n("#place_order").attr("disabled",!1),n("#wc-moneris-tokenize-payment-method").parent().hide()):n("#place_order").attr("disabled",!1),this.termsCheckboxHandling()}}])})(),n(document.body).trigger("wc_moneris_payment_form_handler_loaded")});var woo_login_checkout_recaptcha_verified=function(){window.recaptchaSuccessCallback()},add_payment_method_recaptcha_verified=function(){window.recaptchaSuccessCallback()},woo_guest_checkout_recaptcha_verified=function(){window.recaptchaSuccessCallback()};//# sourceMappingURL=wc-moneris.min.js.map